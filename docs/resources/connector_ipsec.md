---
page_title: "alkira_connector_ipsec Resource - terraform-provider-alkira"
subcategory: ""
description: |-
  Manage IPSec Connector.
---

# alkira_connector_ipsec (Resource)

Manage IPSec Connector.


## VPN Mode

`vpn_mode` could be either `ROUTE_BASED` or `POLICY_BASED`. When it's
defined as `ROUTE_BASED`, `routing_options` block is required. When
it's defined as `POLICY_BASED`, `policy_options` block is required.

An internet exit is an exit from the CXP to the internet and allows
the traffic from the various Users & Sites or Cloud Connectors to flow
towards the Internet.

## Example Usage

```terraform
resource "alkira_connector_ipsec" "ipsec" {
  name           = "connector-test-ipsec"
  cxp            = "US-WEST"
  group          = alkira_group.group1.name
  segment_id     = alkira_segment.segment1.id
  size           = "SMALL"

  vpn_mode       = "ROUTE_BASED"

  routing_options {
    type = "DYNAMIC"
    customer_gateway_asn = "65310"
  }

  # There could be multiple endpoints defined.
  endpoint {
    name                     = "Site1"
    customer_gateway_ip      = "8.8.8.8"
    preshared_keys           = ["1234", "1235"]
    billing_tag_ids          = [alkira_billing_tag.tag1.id]
    enable_tunnel_redundancy = false

    # Optional advanced options could be specified per endpoint.
    advanced_options {
      esp_dh_group_numbers      = ["MODP3072"]
      esp_encryption_algorithms = ["AES256CBC"]
      esp_integrity_algorithms  = ["SHA256"]

      ike_dh_group_numbers      = ["MODP3072"]
      ike_encryption_algorithms = ["AES256CBC"]
      ike_integrity_algorithms  = ["SHA256"]
      ike_version               = "IKEv2"

      initiator          = true

      remote_auth_type   = "IP_ADDR"
      remote_auth_value  = "54.70.233.220"
    }
  }

  endpoint {
      name                 = "Site2"
      customer_gateway_ip  = "9.9.9.9"
      preshared_keys       = ["1234", "1235"]
      billing_tag_ids      = [alkira_billing_tag.tag1.id]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cxp` (String) The CXP where the connector should be provisioned.
- `endpoint` (Block List, Min: 1) The endpoint. (see [below for nested schema](#nestedblock--endpoint))
- `name` (String) The name of the connector.
- `segment_id` (String) The ID of the segment associated with the connector.
- `size` (String) The size of the connector, one of `SMALL`, `MEDIUM`, `LARGE`, `2LARGE`, `5LARGE`, `10LARGE`.
- `vpn_mode` (String) The mode can be configured either as `ROUTE_BASED` or `POLICY_BASED`.

### Optional

- `description` (String) The description of the connector.
- `enabled` (Boolean) Is the connector enabled. Default is `true`.
- `group` (String) The group of the connector. (see resource `alkira_group`)
- `policy_options` (Block Set) Policy options, both `on_prem_prefix_list_ids` and `cxp_prefix_list_ids` must be provided if `vpn_mode` is `POLICY_BASED`. (see [below for nested schema](#nestedblock--policy_options))
- `routing_options` (Block Set) Routing options, type is `STATIC`, `DYNAMIC`, or`BOTH` must be provided if `vpn_mode` is `ROUTE_BASED` (see [below for nested schema](#nestedblock--routing_options))
- `scale_group_id` (String) The ID of the scale group associated with the connector.
- `segment_options` (Block Set) Additional options for each segment associated with the connector. (see [below for nested schema](#nestedblock--segment_options))

### Read-Only

- `id` (String) The ID of this resource.
- `implicit_group_id` (Number) The ID of implicit group automaticaly created with the connector.
- `provision_state` (String) The provision state of the connector.

<a id="nestedblock--endpoint"></a>
### Nested Schema for `endpoint`

Required:

- `customer_gateway_ip` (String) The IP address of the customer gateway.
- `name` (String) The name of the endpoint.
- `preshared_keys` (List of String) An array of preshared keys, one per tunnel. The value needs to be provided explictly unlike portal.

Optional:

- `advanced_options` (Block List) Advanced options for IPSec endpoint. (see [below for nested schema](#nestedblock--endpoint--advanced_options))
- `billing_tag_ids` (Set of Number) Billing tags to be associated with the resource. (see resource `alkira_billing_tag`).
- `customer_ip_type` (String) The type of `customer_gateway_ip`. It could be either `STATIC` or `DYNAMIC`. Default value is `STATIC`. When it's `DYNAMIC`, `customer_gateway_ip` should be set to `0.0.0.0`. `remote_auth_type` in `advanced_options` is required as well.
- `enable_tunnel_redundancy` (Boolean) Disable this if all tunnels will not be configured or enabled on the on-premise device. If it's set to `false`, connector health will be shown as `UP` if at least one of the tunnels is `UP`. If enabled, all tunnels need to be `UP` for the connectorhealth to be shown as `UP`.
- `ha_mode` (String) The value could be `ACTIVE` or `STANDBY`. A endpoint in `STANDBY` mode will not be used for traffic unless all other endpoints for the connector are down. There can only be one endpoint in `STANDBY` mode per connector and there must be at least one endpoint that isn't in `STANDBY` mode per connector.

Read-Only:

- `id` (Number) The ID of the endpoint.

<a id="nestedblock--endpoint--advanced_options"></a>
### Nested Schema for `endpoint.advanced_options`

Required:

- `esp_dh_group_numbers` (List of String) Diffie Hellman groups to use for IPsec SA. Value could `MODP1024`, `MODP2048`, `MODP3072`, `MODP4096`, `MODP6144`, `MODP8192`, `ECP256`, `ECP384`, `ECP521`, `CURVE25519` and `NONE`.
- `esp_encryption_algorithms` (List of String) Encryption algorithms to use for IPsec SA. Value could be `AES256CBC`, `AES192CBC`, `AES128CBC`, `AES256GCM16` `3DESCBC`, or `NULL`.
- `esp_integrity_algorithms` (List of String) Integrity algorithms to use for IPsec SA. Value could `SHA1`, `SHA256`, `SHA384`, `SHA512` or `MD5`.
- `ike_dh_group_numbers` (List of String) Diffie Hellman groups to use for IKE SA, one of `MODP1024`, `MODP2048`, `MODP3072`, `MODP4096`, `MODP6144`, `MODP8192`, `ECP256`, `ECP384`, `ECP521`, `CURVE25519`.
- `ike_encryption_algorithms` (List of String) Encryption algorithms to use for IKE SA, one of `AES256CBC`, `AES192CBC`, `AES128CBC` and `3DESCBC`.
- `ike_integrity_algorithms` (List of String) Integrity algorithms to use for IKE SA, one of `SHA1`, `SHA256`, `SHA384`, `SHA512`.
- `ike_version` (String) IKE version, either `IKEv1` or `IKEv2`
- `initiator` (Boolean) When true CXP will initiate the IKE connection and if false then the customer gateway should initiate IKE. When `gateway_ip_type` is `DYNAMIC`, initiator must be `true`.
- `remote_auth_type` (String) Remote-ID type - IKE identity to use for authentication round, one of `FQDN`, `USER_FQDN`, `KEYID`, `IP_ADDR`.
- `remote_auth_value` (String) Remote-ID value.



<a id="nestedblock--policy_options"></a>
### Nested Schema for `policy_options`

Required:

- `cxp_prefix_list_ids` (List of Number) CXP Prefix List IDs.
- `on_prem_prefix_list_ids` (List of Number) On Prem Prefix List IDs.


<a id="nestedblock--routing_options"></a>
### Nested Schema for `routing_options`

Required:

- `type` (String) Routing type, one of `STATIC`, `DYNAMIC`, or `BOTH`.

Optional:

- `availability` (String) The method to determine the availability of the routes. The value could be `IKE_STATUS` or `IPSEC_INTERFACE_PING`. Default value is `IPSEC_INTERFACE_PING`.
- `bgp_auth_key` (String) BGP MD5 auth key for Alkira to authenticate Alkira CXP (On Premise Gateway).
- `customer_gateway_asn` (String) The customer gateway ASN to use for dynamic route propagation.
- `prefix_list_id` (Number) The ID of prefix list to use for static route propagation.


<a id="nestedblock--segment_options"></a>
### Nested Schema for `segment_options`

Required:

- `name` (String) Segment Name.

Optional:

- `advertise_default_route` (Boolean) Enable or disable access to the internet when traffic arrives via this connector. Default is `false`.
- `advertise_on_prem_routes` (Boolean) Additional options for each segment associated with the connector. Default is `false`.

## Import

Import is supported using the following syntax:

```shell
terraform import alkira_connector_ipsec.example CONNECTOR_ID
```
