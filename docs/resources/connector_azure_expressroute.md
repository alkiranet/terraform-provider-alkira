---
page_title: "alkira_connector_azure_expressroute Resource - terraform-provider-alkira"
subcategory: ""
description: |-
  Manage Azure ExpressRoute Connector. (BETA)
---

# alkira_connector_azure_expressroute (Resource)

Manage Azure ExpressRoute Connector. (**BETA**)
# Simple Example with one segment Option
```terraform
resource "alkira_connector_azure_expressroute" "example" {
  name            = "example"
  description     = "example connector"
  size            = "LARGE"
  enabled         = true
  vhub_prefix     = "10.129.0.0/23"
  cxp             = "USWEST-AZURE-1"
  tunnel_protocol = "VXLAN_GPE"
  group           = alkira_group.example.name

  instances {
    name                      = "InstanceName"
    expressroute_circuit_id   = "/subscriptions/<Id>/resourceGroups/<GroupName>/providers/Microsoft.Network/expressRouteCircuits/<CircuitName>"
    redundant_router          = true
    loopback_subnet           = "192.168.18.0/26"
    credential_id             = alkira_credential_azure_vnet.example.id
    gateway_mac_address       = ["00:1A:2B:3C:4D:5E", "00:6F:7G:8H:9I:0J"]
    virtual_network_interface = [16773024, 16773025]

    segment_options {
      segment_name = alkira_segment.example.name
      customer_gateways {
        name = "gateway1"
        tunnels {
          name              = "tunnel1"
          ike_version       = "IKEv2"
          initiator         = true
          pre_shared_key    = "secretkey123"
          profile_id        = 1
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvalue123"
        }
      }
    }
  }

  segment_options {
    segment_name             = alkira_segment.example.name
    customer_asn             = "65514"
    disable_internet_exit    = false
    advertise_on_prem_routes = false
  }
}
```

# Multiple Segment Options
```terraform
resource "alkira_connector_azure_expressroute" "example2" {
  name            = "example2"
  size            = "LARGE"
  enabled         = true
  vhub_prefix     = "10.129.0.0/23"
  cxp             = "USWEST-AZURE-1"
  tunnel_protocol = "IPSEC"
  group           = alkira_group.example.name

  instances {
    name                    = "InstanceName"
    expressroute_circuit_id = "/subscriptions/<Id>/resourceGroups/<GroupName>/providers/Microsoft.Network/expressRouteCircuits/<CircuitName2>"
    redundant_router        = true
    loopback_subnet         = "192.168.19.0/26"
    credential_id           = alkira_credential_azure_vnet.example2.id

    segment_options {
      segment_name = alkira_segment.example.name
      customer_gateways {
        name = "gateway1"
        tunnels {
          name              = "tunnel1"
          ike_version       = "IKEv2"
          initiator         = true
          pre_shared_key    = "secretkey456"
          profile_id        = 2
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvalue456"
        }
        tunnels {
          name              = "tunnel2"
          ike_version       = "IKEv2"
          initiator         = false
          pre_shared_key    = "secretkey789"
          profile_id        = 3
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvalue789"
        }
      }
      customer_gateways {
        name = "gateway2"
        tunnels {
          name              = "tunnel1"
          ike_version       = "IKEv2"
          initiator         = true
          pre_shared_key    = "secretkeyabc"
          profile_id        = 4
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvalueabc"
        }
      }
    }

    segment_options {
      segment_name = alkira_segment.example1.name
      customer_gateways {
        name = "gateway3"
        tunnels {
          name              = "tunnel1"
          ike_version       = "IKEv2"
          initiator         = true
          pre_shared_key    = "secretkeyxyz"
          profile_id        = 5
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvaluexyz"
        }
      }
    }
  }

  segment_options {
    segment_name             = alkira_segment.example.name
    customer_asn             = "65514"
    disable_internet_exit    = false
    advertise_on_prem_routes = false
  }
  segment_options {
    segment_name             = alkira_segment.example1.name
    customer_asn             = "65515"
    disable_internet_exit    = false
    advertise_on_prem_routes = false
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cxp` (String) The CXP where the connector should be provisioned.
- `instances` (Block List, Min: 1) (see [below for nested schema](#nestedblock--instances))
- `name` (String) The name of the connector.
- `segment_options` (Block List, Min: 1) (see [below for nested schema](#nestedblock--segment_options))
- `size` (String) The size of the connector, one of `SMALL`, `MEDIUM`, `LARGE`, `2LARGE`, `5LARGE`, `10LARGE`.
- `vhub_prefix` (String) IP address prefix for VWAN Hub. This should be a `/23` prefix.

### Optional

- `billing_tag_ids` (Set of Number) Billing tags to be associated with the resource. (see resource `alkira_billing_tag`).
- `description` (String) The description of the connector.
- `enabled` (Boolean) Is the connector enabled. Default is `true`.
- `group` (String) The group of the connector.
- `tunnel_protocol` (String) The tunnel protocol. One of `VXLAN`, `VXLAN_GPE`. Default is `VXLAN_GPE`

### Read-Only

- `id` (String) The ID of this resource.
- `provision_state` (String) The provision state of the connector.

<a id="nestedblock--instances"></a>
### Nested Schema for `instances`

Required:

- `credential_id` (String) An opaque identifier generated when storing Azure VNET credentials.
- `expressroute_circuit_id` (String) ExpressRoute circuit ID from Azure. ExpresRoute Circuit should have a private peering connection provisioned, also an valid authorization key associated with it.
- `loopback_subnet` (String) A `/26` subnet from which loopback IPs would be used to establish underlay VXLAN GPE tunnels.
- `name` (String) User provided connector instance name.
- `segment_options` (Block List, Min: 1) Instance level segment specific routing and gateway configurations.Only required when `tunnel_protocol` is `IPSEC`. (see [below for nested schema](#nestedblock--instances--segment_options))

Optional:

- `gateway_mac_address` (List of String) An array containing the mac addresses of VXLAN gateways reachable through ExpressRoute circuit. The field is only expected if VXLAN tunnel protocol is selected, and 2 gateway MAC addresses are expected only if `redundant_router` is enabled.
- `redundant_router` (Boolean) Indicates if ExpressRoute Circuit terminates on redundant routers on customer side.
- `virtual_network_interface` (List of Number) This is an optional field if the `tunnel_protocol` is `VXLAN`. If not specified Alkira allocates unique VNI from the range `[16773023, 16777215]`.

Read-Only:

- `id` (Number)

<a id="nestedblock--instances--segment_options"></a>
### Nested Schema for `instances.segment_options`

Required:

- `customer_gateways` (Block List, Min: 1) Customer gateway configurations for `IPSEC` tunnels. Required only if `tunnel_protocol` is `IPSEC`. (see [below for nested schema](#nestedblock--instances--segment_options--customer_gateways))
- `segment_name` (String) The name of an existing segment in the Alkira environment.

<a id="nestedblock--instances--segment_options--customer_gateways"></a>
### Nested Schema for `instances.segment_options.customer_gateways`

Required:

- `name` (String) A unique name for the customer gateway.
- `tunnels` (Block List, Min: 1) Tunnel configurations for the gateway. At least one tunnel is required for `IPSEC`. (see [below for nested schema](#nestedblock--instances--segment_options--customer_gateways--tunnels))

<a id="nestedblock--instances--segment_options--customer_gateways--tunnels"></a>
### Nested Schema for `instances.segment_options.customer_gateways.tunnels`

Required:

- `name` (String) A unique name for the tunnel.

Optional:

- `ike_version` (String) The IKE protocol version. Currently, only `IKEv2` is supported.
- `initiator` (Boolean) Whether this endpoint initiates the tunnel connection.
- `pre_shared_key` (String, Sensitive) The pre-shared key for tunnel authentication. This field is sensitive and will not be displayed in logs.
- `profile_id` (Number) The ID of the tunnel profile to use.
- `remote_auth_type` (String) The authentication type for the remote endpoint. Only `FQDN` iscurrently supported.
- `remote_auth_value` (String, Sensitive) The authentication value for the remote endpoint. This field is sensitive.

Read-Only:

- `id` (String) The ID of the tunnel.





<a id="nestedblock--segment_options"></a>
### Nested Schema for `segment_options`

Required:

- `customer_asn` (Number) ASN on the customer premise side.
- `segment_name` (String) The name of an existing segment.

Optional:

- `advertise_on_prem_routes` (Boolean) Allow routes from the branch/premises to be advertised to the cloud.
- `disable_internet_exit` (Boolean) Enable or disable access to the internet when traffic arrives via this connector.

Read-Only:

- `segment_id` (Number) The ID of the segment.
