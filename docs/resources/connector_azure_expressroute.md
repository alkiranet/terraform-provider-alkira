---
page_title: "alkira_connector_azure_expressroute Resource - terraform-provider-alkira"
subcategory: ""
description: |-
  Manages an Azure ExpressRoute Connector. This resource is in BETA and may require careful handling.
---

# alkira_connector_azure_expressroute (Resource)

Manages an Azure ExpressRoute Connector. This resource is in **BETA** and may require careful handling.
# Simple Example with one segment Option
```terraform
resource "alkira_connector_azure_expressroute" "example" {
  name            = "example"
  description     = "example connector"
  size            = "LARGE"
  enabled         = true
  vhub_prefix     = "10.129.0.0/23"
  cxp             = "USWEST-AZURE-1"
  tunnel_protocol = "VXLAN_GPE"
  group           = alkira_group.example.name

  instances {
    name                      = "InstanceName"
    expressroute_circuit_id   = "/subscriptions/<Id>/resourceGroups/<GroupName>/providers/Microsoft.Network/expressRouteCircuits/<CircuitName>"
    redundant_router          = true
    loopback_subnet           = "192.168.18.0/26"
    credential_id             = alkira_credential_azure_vnet.example.id
    gateway_mac_address       = ["00:1A:2B:3C:4D:5E", "00:6F:7G:8H:9I:0J"]
    virtual_network_interface = [16773024, 16773025]

    segment_options {
      segment_name = alkira_segment.example.name
      customer_gateways {
        name = "gateway1"
        tunnels {
          name              = "tunnel1"
          ike_version       = "IKEv2"
          initiator         = true
          pre_shared_key    = "secretkey123"
          profile_id        = 1
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvalue123"
        }
      }
    }
  }

  segment_options {
    segment_name             = alkira_segment.example.name
    customer_asn             = "65514"
    disable_internet_exit    = false
    advertise_on_prem_routes = false
  }
}
```

# Multiple Segment Options
```terraform
resource "alkira_connector_azure_expressroute" "example2" {
  name            = "example2"
  size            = "LARGE"
  enabled         = true
  vhub_prefix     = "10.129.0.0/23"
  cxp             = "USWEST-AZURE-1"
  tunnel_protocol = "IPSEC"
  group           = alkira_group.example.name

  instances {
    name                    = "InstanceName"
    expressroute_circuit_id = "/subscriptions/<Id>/resourceGroups/<GroupName>/providers/Microsoft.Network/expressRouteCircuits/<CircuitName2>"
    redundant_router        = true
    loopback_subnet         = "192.168.19.0/26"
    credential_id           = alkira_credential_azure_vnet.example2.id

    segment_options {
      segment_name = alkira_segment.example.name
      customer_gateways {
        name = "gateway1"
        tunnels {
          name              = "tunnel1"
          ike_version       = "IKEv2"
          initiator         = true
          pre_shared_key    = "secretkey456"
          profile_id        = 2
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvalue456"
        }
        tunnels {
          name              = "tunnel2"
          ike_version       = "IKEv2"
          initiator         = false
          pre_shared_key    = "secretkey789"
          profile_id        = 3
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvalue789"
        }
      }
      customer_gateways {
        name = "gateway2"
        tunnels {
          name              = "tunnel1"
          ike_version       = "IKEv2"
          initiator         = true
          pre_shared_key    = "secretkeyabc"
          profile_id        = 4
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvalueabc"
        }
      }
    }

    segment_options {
      segment_name = alkira_segment.example1.name
      customer_gateways {
        name = "gateway3"
        tunnels {
          name              = "tunnel1"
          ike_version       = "IKEv2"
          initiator         = true
          pre_shared_key    = "secretkeyxyz"
          profile_id        = 5
          remote_auth_type  = "FQDN"
          remote_auth_value = "authvaluexyz"
        }
      }
    }
  }

  segment_options {
    segment_name             = alkira_segment.example.name
    customer_asn             = "65514"
    disable_internet_exit    = false
    advertise_on_prem_routes = false
  }
  segment_options {
    segment_name             = alkira_segment.example1.name
    customer_asn             = "65515"
    disable_internet_exit    = false
    advertise_on_prem_routes = false
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cxp` (String) The Cloud Exchange Point (CXP) where the connector will be provisioned.
- `instances` (Block List, Min: 1) Configuration for individual Azure ExpressRoute instances linked to this connector. (see [below for nested schema](#nestedblock--instances))
- `name` (String) The unique name of the Azure ExpressRoute connector.
- `segment_options` (Block List, Min: 1) Global segment routing and policy configurations for the connector. (see [below for nested schema](#nestedblock--segment_options))
- `size` (String) The size of the connector. Valid values are `SMALL`, `MEDIUM`, `LARGE`, `2LARGE`, `5LARGE`, or `10LARGE`.
- `vhub_prefix` (String) The CIDR block (in `/23` notation) reserved for the Azure Virtual WAN Hub.

### Optional

- `billing_tag_ids` (Set of Number) A list of billing tag IDs to associate with this connector. Billing tags must be created using the `alkira_billing_tag` resource.
- `description` (String) The description of the connector.
- `enabled` (Boolean) Whether the connector is operational. Defaults to `true`.
- `group` (String) The organizational group to which this connector belongs within the Alkira platform.
- `tunnel_protocol` (String) The encapsulation protocol for the tunnels. Valid values are `VXLAN` or `VXLAN_GPE` or `IPSEC`. Defaults to `VXLAN_GPE`.

### Read-Only

- `id` (String) The ID of this resource.
- `provision_state` (String) The current provisioning state of the connector, as reported by the Alkira platform.

<a id="nestedblock--instances"></a>
### Nested Schema for `instances`

Required:

- `credential_id` (String) The credential ID obtained after storing Azure VNET credentials in the Alkira platform.
- `expressroute_circuit_id` (String) The Azure-assigned ID of the ExpressRoute Circuit. The circuit must have private peering configured and a valid authorization key.
- `loopback_subnet` (String) A `/26` subnet used to allocate loopback IPs for establishing `VXLAN/GPE` underlay tunnels.
- `name` (String) A user-defined name for the connector instance.
- `segment_options` (Block List, Min: 1) Instance level segment specific routing and gateway configurations.Only required when `tunnel_protocol` is `IPSEC`. (see [below for nested schema](#nestedblock--instances--segment_options))

Optional:

- `gateway_mac_address` (List of String) MAC addresses of VXLAN gateways accessible via the ExpressRoute Circuit. Required if `tunnel_protocol` is `VXLAN`. Provide two addresses if `redundant_router` is `true`.
- `redundant_router` (Boolean) Whether the ExpressRoute Circuit connects to redundant routers on the customer side. Defaults to `false`.
- `virtual_network_interface` (List of Number) Virtual Network Interface (VNI) identifiers. If unspecified, Alkira auto-allocates from the range `16773023-16777215`. Onlyapplicable for `VXLAN` tunnels.

Read-Only:

- `id` (Number) The auto-generated ID of the connector instance.

<a id="nestedblock--instances--segment_options"></a>
### Nested Schema for `instances.segment_options`

Required:

- `customer_gateways` (Block List, Min: 1) Customer gateway configurations for `IPSEC` tunnels. Required only if `tunnel_protocol` is `IPSEC`. (see [below for nested schema](#nestedblock--instances--segment_options--customer_gateways))
- `segment_name` (String) The name of an existing segment in the Alkira environment.

<a id="nestedblock--instances--segment_options--customer_gateways"></a>
### Nested Schema for `instances.segment_options.customer_gateways`

Required:

- `name` (String) A unique name for the customer gateway.
- `tunnels` (Block List, Min: 1) Tunnel configurations for the gateway. At least one tunnel is required for `IPSEC`. (see [below for nested schema](#nestedblock--instances--segment_options--customer_gateways--tunnels))

<a id="nestedblock--instances--segment_options--customer_gateways--tunnels"></a>
### Nested Schema for `instances.segment_options.customer_gateways.tunnels`

Required:

- `name` (String) A unique name for the tunnel.

Optional:

- `ike_version` (String) The IKE protocol version. Currently, only `IKEv2` is supported.
- `initiator` (Boolean) Whether this endpoint initiates the tunnel connection.
- `pre_shared_key` (String, Sensitive) The pre-shared key for tunnel authentication. This field is sensitive and will not be displayed in logs.
- `profile_id` (Number) The ID of the tunnel profile to use.
- `remote_auth_type` (String) The authentication type for the remote endpoint. Only `FQDN` iscurrently supported.
- `remote_auth_value` (String, Sensitive) The authentication value for the remote endpoint. This field is sensitive.

Read-Only:

- `id` (String) The ID of the tunnel.





<a id="nestedblock--segment_options"></a>
### Nested Schema for `segment_options`

Required:

- `customer_asn` (Number) The Autonomous System Number (ASN) configured on the customer's premises.
- `segment_name` (String) The name of the segment to associate with this connector.

Optional:

- `advertise_on_prem_routes` (Boolean) When enabled, routes from on-premises networks are advertised to Azure. Defaults to `false`.
- `disable_internet_exit` (Boolean) When enabled, traffic arriving via this connector cannot access the internet. Defaults to `true`.

Read-Only:

- `segment_id` (Number) The auto-generated ID of the segment within the Alkira platform.


