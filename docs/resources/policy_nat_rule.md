---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "alkira_policy_nat_rule Resource - terraform-provider-alkira"
subcategory: ""
description: |-
  Manage policy NAT rule.
  This resource is usually used along with policy resources:policy_nat_policy.
---

# alkira_policy_nat_rule (Resource)

Manage policy NAT rule.

This resource is usually used along with policy resources:`policy_nat_policy`.

## Example Usage

```terraform
# Example 1: Basic NAT rule with no translation
resource "alkira_policy_nat_rule" "basic" {
  name        = "basic-nat-rule"
  description = "Basic NAT rule example"
  enabled     = true
  category    = "DEFAULT"

  match {
    src_prefixes = ["10.0.0.0/8"]
    dst_prefixes = ["192.168.0.0/16"]
    protocol     = "tcp"
    src_ports    = ["80", "443"]
    dst_ports    = ["80", "443"]
  }

  action {
    src_addr_translation_type = "NONE"
    dst_addr_translation_type = "NONE"
  }
}

# Example 2: NAT rule with static IP translation
resource "alkira_policy_nat_rule" "static_ip" {
  name        = "static-ip-nat-rule"
  description = "NAT rule with static IP translation"
  enabled     = true
  category    = "DEFAULT"

  match {
    src_prefixes = ["10.0.0.0/8"]
    dst_prefixes = ["any"]
    protocol     = "any"
  }

  action {
    src_addr_translation_type     = "STATIC_IP"
    src_addr_translation_prefixes = ["192.168.1.0/24"]
    dst_addr_translation_type     = "NONE"
    egress_type                   = "ALKIRA_PUBLIC_IP"
  }
}

# Example 3: NAT rule with dynamic IP and port translation
resource "alkira_policy_nat_rule" "dynamic_ip_port" {
  name        = "dynamic-ip-port-nat-rule"
  description = "NAT rule with dynamic IP and port translation"
  enabled     = true
  category    = "INTERNET_CONNECTOR"

  match {
    src_prefixes = ["10.0.0.0/8"]
    dst_prefixes = ["any"]
    protocol     = "tcp"
  }

  action {
    src_addr_translation_type = "DYNAMIC_IP_AND_PORT"
    dst_addr_translation_type = "NONE"
    egress_type               = "BYOIP"
  }
}

# Example 4: NAT rule with destination translation and port mapping
resource "alkira_policy_nat_rule" "dest_translation" {
  name        = "dest-translation-nat-rule"
  description = "NAT rule with destination translation"
  enabled     = true

  match {
    src_prefixes = ["any"]
    dst_prefixes = ["203.0.113.0/24"]
    protocol     = "tcp"
    dst_ports    = ["80"]
  }

  action {
    src_addr_translation_type                   = "NONE"
    dst_addr_translation_type                   = "STATIC_IP_AND_PORT"
    dst_addr_translation_prefixes               = ["10.0.1.100/32"]
    dst_addr_translation_ports                  = ["8080"]
    dst_addr_translation_advertise_to_connector = true
  }
}

# Example 5: Advanced NAT rule with prefix lists and routing tracking
resource "alkira_list_global_cidr" "source_prefixes" {
  name        = "source-prefixes-list"
  description = "Source prefixes for NAT rule"
  values      = ["10.0.0.0/8", "172.16.0.0/12"]
}

resource "alkira_list_global_cidr" "dest_prefixes" {
  name        = "dest-prefixes-list"
  description = "Destination prefixes for NAT rule"
  values      = ["192.168.0.0/16"]
}

resource "alkira_list_global_cidr" "track_prefixes" {
  name        = "track-prefixes-list"
  description = "Prefixes to track for routing"
  values      = ["203.0.113.0/24"]
}

resource "alkira_policy_nat_rule" "advanced" {
  name        = "advanced-nat-rule"
  description = "Advanced NAT rule with prefix lists and routing tracking"
  enabled     = true
  category    = "DEFAULT"

  match {
    src_prefix_list_ids = [alkira_list_global_cidr.source_prefixes.id]
    dst_prefix_list_ids = [alkira_list_global_cidr.dest_prefixes.id]
    protocol            = "tcp"
  }

  action {
    src_addr_translation_type                              = "STATIC_IP"
    src_addr_translation_prefixes                          = ["198.51.100.0/24"]
    src_addr_translation_routing_track_prefix_list_ids     = [alkira_list_global_cidr.track_prefixes.id]
    src_addr_translation_routing_track_invalidate_prefixes = true
    dst_addr_translation_type                              = "NONE"
    egress_type                                            = "ALKIRA_PUBLIC_IP"
  }
}

# Example 6: OUTBOUND NAT rule with dynamic IP and port translation
resource "alkira_policy_nat_rule" "outbound_nat" {
  name        = "outbound-nat-rule"
  description = "Outbound NAT rule with dynamic IP and port translation"
  enabled     = true
  direction   = "OUTBOUND"

  match {
    src_prefixes = ["192.168.0.0/16"]
    dst_prefixes = ["any"]
    src_ports    = ["any"]
    dst_ports    = ["any"]
    protocol     = "any"
  }

  action {
    src_addr_translation_type                = "DYNAMIC_IP_AND_PORT"
    src_addr_translation_prefixes            = ["10.1.55.100/31"]
    src_addr_translation_match_and_invalidate = false
    dst_addr_translation_type                = "NONE"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `action` (Block Set, Min: 1) The action of the rule. (see [below for nested schema](#nestedblock--action))
- `enabled` (Boolean) Enable the rule or not.
- `match` (Block Set, Min: 1) Match condition for the rule. (see [below for nested schema](#nestedblock--match))
- `name` (String) The name of the policy rule.

### Optional

- `category` (String) The category of NAT rule. The value could be `DEFAULT` or `INTERNET_CONNECTOR`. Default value is `DEFAULT`.
- `description` (String) The description of the policy rule.
- `direction` (String) The direction of NAT rule. The value could be `INBOUND` or `OUTBOUND`.

### Read-Only

- `id` (String) The ID of this resource.
- `provision_state` (String) the provision state of the resource.

<a id="nestedblock--action"></a>
### Nested Schema for `action`

Optional:

- `dst_addr_translation_advertise_to_connector` (Boolean) Whether the destination address should be advertised to connector.
- `dst_addr_translation_list_policy_fqdn_id` (Number) The ID of policy FQDN list.
- `dst_addr_translation_ports` (List of String) The port list to translate the destination prefixes to.
- `dst_addr_translation_prefix_list_ids` (List of Number) The list of prefix list IDs.
- `dst_addr_translation_prefixes` (List of String) The list of prefixes.
- `dst_addr_translation_routing_invalidate_prefixes` (Boolean) Whether to invalidate the track prefixes. Default value is `false`.
- `dst_addr_translation_routing_track_prefix_list_ids` (List of Number) The list of prefix list IDs to track.
- `dst_addr_translation_routing_track_prefixes` (List of String) The list of prefixes to track.
- `dst_addr_translation_type` (String) The translation type are: `STATIC_IP`, `STATIC_IP_AND_PORT` , `STATIC_PORT` and `NONE`. Default value is `NONE`.
- `egress_type` (String) The egress type to use with the match. Options are are `ALKIRA_PUBLIC_IP` or `BYOIP`.
- `src_addr_translation_match_and_invalidate` (Boolean) Whether the translation match and invalidate. Default is `true`.
- `src_addr_translation_prefix_list_ids` (List of Number) The list of prefix list IDs.
- `src_addr_translation_prefixes` (List of String) The list of prefixes.
- `src_addr_translation_routing_track_invalidate_prefixes` (Boolean) Whether to invalidate the track prefixes. Default value is `false`.
- `src_addr_translation_routing_track_prefix_list_ids` (List of Number) The list of prefix list IDs.
- `src_addr_translation_routing_track_prefixes` (List of String) The list of prefixes to track.
- `src_addr_translation_type` (String) The translation type are: `STATIC_IP`, `DYNAMIC_IP_AND_PORT` and `NONE`. Default value is `NONE`.


<a id="nestedblock--match"></a>
### Nested Schema for `match`

Required:

- `protocol` (String) The following protocols are supported, `icmp`, `tcp`, `udp` or `any`.

Optional:

- `dst_ports` (List of String) The list of ports for destination.
- `dst_prefix_list_ids` (List of Number) The list of prefix IDs as destination.
- `dst_prefixes` (List of String) The list of prefixes for destination.
- `src_ports` (List of String) The list of ports for source.
- `src_prefix_list_ids` (List of Number) The list of prefix IDs as source.
- `src_prefixes` (List of String) The list of prefixes for source.

## Import

Import is supported using the following syntax:

```shell
#!/bin/bash

terraform import alkira_policy_nat_rule.basic <nat_rule_id>
```
